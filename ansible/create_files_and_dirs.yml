- name: Create files and dirs
  hosts: localhost
  connection: local 
  tasks:
    - name: Create directories
      file:
        path: "{{ item.path }}"
        mode: "{{ item.mode }}"
        state: directory
      become: "{{ item.become }}"
      become_method: su
      with_items:
        - { path: "{{ lookup('env', 'RUNTIME_FILES_DIR') }}" , mode: '0755', become: 'no' }

    - name: Create files
      file:
        path: "{{ item.path }}"
        mode: "{{ item.mode }}"
        state: touch
      become: "{{ item.become }}"
      become_method: su
      with_items:
        - { path: "{{ lookup('env', 'RUNTIME_FILES_DIR') }}/input", mode: '0644', become: 'no' }
        - { path: "{{ lookup('env', 'RUNTIME_FILES_DIR') }}/output", mode: '0644', become: 'no' }
        - { path: "{{ lookup('env', 'RUNTIME_FILES_DIR') }}/source", mode: '0644', become: 'no' }
        - { path: "{{ lookup('env', 'RUNTIME_FILES_DIR') }}/compiled", mode: '0755', become: 'no' }
